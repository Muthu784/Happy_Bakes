{"ast":null,"code":"import _objectSpread from\"M:/Project-work/bakes/bake/Client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useLocation,useNavigate}from'react-router-dom';import axios from'axios';import{useUser}from'../context/UserContext';import'../Styles/UserOrder.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UserOrders=()=>{const location=useLocation();const navigate=useNavigate();const{user}=useUser();const[orderedItems,setOrderedItems]=useState(()=>{const savedOrders=localStorage.getItem('orderedItems');return savedOrders?JSON.parse(savedOrders):[];});const[orderPlaced,setOrderPlaced]=useState(false);useEffect(()=>{var _location$state;if((_location$state=location.state)!==null&&_location$state!==void 0&&_location$state.orderedItem){setOrderedItems(prevItems=>{const existingItem=prevItems.find(item=>item.name===location.state.orderedItem.name);let updatedItems;if(existingItem){// If item exists, don't increment quantity automatically\nreturn prevItems;}else{updatedItems=[...prevItems,_objectSpread(_objectSpread({},location.state.orderedItem),{},{quantity:1,product:location.state.orderedItem.name})];}localStorage.setItem('orderedItems',JSON.stringify(updatedItems));return updatedItems;});}},[location.state]);const handleIncreaseQuantity=index=>{setOrderedItems(prevItems=>{const updatedItems=prevItems.map((item,i)=>i===index?_objectSpread(_objectSpread({},item),{},{quantity:item.quantity+1}):item);localStorage.setItem('orderedItems',JSON.stringify(updatedItems));return updatedItems;});};const handleDecreaseQuantity=index=>{setOrderedItems(prevItems=>{const updatedItems=prevItems.filter((item,i)=>!(i===index&&item.quantity===1)).map((item,i)=>i===index?_objectSpread(_objectSpread({},item),{},{quantity:item.quantity-1}):item);localStorage.setItem('orderedItems',JSON.stringify(updatedItems));return updatedItems;});};const handleDeleteItem=index=>{setOrderedItems(prevItems=>{const updatedItems=prevItems.filter((_,i)=>i!==index);localStorage.setItem('orderedItems',JSON.stringify(updatedItems));return updatedItems;});};const handleOrderNow=async()=>{if(orderedItems.length===0){console.error('No items to order.');return;}try{const orderData={products:orderedItems.map(item=>({product:item.name,quantity:item.quantity,price:item.price})),user:user?user.email:null};console.log('Sending order data:',orderData);const response=await axios.post('http://localhost:5000/api/order/createOrder',orderData,{withCredentials:true});console.log('Order placed successfully:',response.data);setOrderPlaced(true);setOrderedItems([]);localStorage.removeItem('orderedItems');}catch(error){console.error('Error placing order:',error.response?error.response.data:error.message);}};const totalPrice=orderedItems.reduce((total,item)=>total+item.price*item.quantity,0);return/*#__PURE__*/_jsxs(\"div\",{className:\"user-orders-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Your Orders\"}),orderedItems.length===0&&!orderPlaced?/*#__PURE__*/_jsx(\"p\",{children:\"No orders yet. Start shopping!\"}):/*#__PURE__*/_jsx(\"div\",{className:\"ordered-items-list\",children:orderedItems.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"ordered-item\",children:[/*#__PURE__*/_jsx(\"h3\",{children:item.name}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Price: \\u20B9\",item.price.toFixed(2)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"quantity-controls\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"small-button\",onClick:()=>handleDecreaseQuantity(index),disabled:item.quantity===1,children:\"-\"}),/*#__PURE__*/_jsx(\"span\",{children:item.quantity}),/*#__PURE__*/_jsx(\"button\",{className:\"small-button\",onClick:()=>handleIncreaseQuantity(index),children:\"+\"}),/*#__PURE__*/_jsx(\"button\",{className:\"delete-button\",onClick:()=>handleDeleteItem(index),children:\"Delete\"})]})]},index))}),orderedItems.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"order-summary\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Total Price: \\u20B9\",totalPrice.toFixed(2)]}),/*#__PURE__*/_jsx(\"button\",{className:\"order-now-button\",onClick:handleOrderNow,children:\"Order Now\"})]}),orderPlaced&&/*#__PURE__*/_jsx(\"div\",{className:\"order-placed-message\",children:\"Your Order is Placed!\"}),/*#__PURE__*/_jsx(\"button\",{className:\"go-back-button\",onClick:()=>navigate(-1),children:\"Go Back\"})]});};export default UserOrders;","map":{"version":3,"names":["React","useState","useEffect","useLocation","useNavigate","axios","useUser","jsx","_jsx","jsxs","_jsxs","UserOrders","location","navigate","user","orderedItems","setOrderedItems","savedOrders","localStorage","getItem","JSON","parse","orderPlaced","setOrderPlaced","_location$state","state","orderedItem","prevItems","existingItem","find","item","name","updatedItems","_objectSpread","quantity","product","setItem","stringify","handleIncreaseQuantity","index","map","i","handleDecreaseQuantity","filter","handleDeleteItem","_","handleOrderNow","length","console","error","orderData","products","price","email","log","response","post","withCredentials","data","removeItem","message","totalPrice","reduce","total","className","children","toFixed","onClick","disabled"],"sources":["M:/Project-work/bakes/bake/Client/src/Pages/UserOrder.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { useUser } from '../context/UserContext';\r\nimport '../Styles/UserOrder.css';\r\n\r\nconst UserOrders = () => {\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const { user } = useUser();\r\n  const [orderedItems, setOrderedItems] = useState(() => {\r\n    const savedOrders = localStorage.getItem('orderedItems');\r\n    return savedOrders ? JSON.parse(savedOrders) : [];\r\n  });\r\n  const [orderPlaced, setOrderPlaced] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (location.state?.orderedItem) {\r\n      setOrderedItems((prevItems) => {\r\n        const existingItem = prevItems.find(\r\n          (item) => item.name === location.state.orderedItem.name\r\n        );\r\n\r\n        let updatedItems;\r\n        if (existingItem) {\r\n          // If item exists, don't increment quantity automatically\r\n          return prevItems;\r\n        } else {\r\n          updatedItems = [\r\n            ...prevItems,\r\n            {\r\n              ...location.state.orderedItem,\r\n              quantity: 1,\r\n              product: location.state.orderedItem.name\r\n            }\r\n          ];\r\n        }\r\n\r\n        localStorage.setItem('orderedItems', JSON.stringify(updatedItems));\r\n        return updatedItems;\r\n      });\r\n    }\r\n  }, [location.state]);\r\n\r\n  const handleIncreaseQuantity = (index) => {\r\n    setOrderedItems((prevItems) => {\r\n      const updatedItems = prevItems.map((item, i) =>\r\n        i === index ? { ...item, quantity: item.quantity + 1 } : item\r\n      );\r\n      localStorage.setItem('orderedItems', JSON.stringify(updatedItems));\r\n      return updatedItems;\r\n    });\r\n  };\r\n\r\n  const handleDecreaseQuantity = (index) => {\r\n    setOrderedItems((prevItems) => {\r\n      const updatedItems = prevItems.filter((item, i) => !(i === index && item.quantity === 1))\r\n        .map((item, i) => (i === index ? { ...item, quantity: item.quantity - 1 } : item));\r\n      localStorage.setItem('orderedItems', JSON.stringify(updatedItems));\r\n      return updatedItems;\r\n    });\r\n  };\r\n\r\n  const handleDeleteItem = (index) => {\r\n    setOrderedItems((prevItems) => {\r\n      const updatedItems = prevItems.filter((_, i) => i !== index);\r\n      localStorage.setItem('orderedItems', JSON.stringify(updatedItems));\r\n      return updatedItems;\r\n    });\r\n  };\r\n\r\n  const handleOrderNow = async () => {\r\n    if (orderedItems.length === 0) {\r\n      console.error('No items to order.');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const orderData = {\r\n        products: orderedItems.map(item => ({\r\n          product: item.name,\r\n          quantity: item.quantity,\r\n          price: item.price\r\n        })),\r\n        user: user ? user.email : null\r\n      };\r\n\r\n      console.log('Sending order data:', orderData);\r\n      const response = await axios.post('http://localhost:5000/api/order/createOrder', orderData, {\r\n        withCredentials: true\r\n      });\r\n\r\n      console.log('Order placed successfully:', response.data);\r\n      setOrderPlaced(true);\r\n      setOrderedItems([]);\r\n      localStorage.removeItem('orderedItems');\r\n    } catch (error) {\r\n      console.error('Error placing order:', error.response ? error.response.data : error.message);\r\n    }\r\n  };\r\n\r\n  const totalPrice = orderedItems.reduce(\r\n    (total, item) => total + item.price * item.quantity,\r\n    0\r\n  );\r\n\r\n  return (\r\n    <div className=\"user-orders-container\">\r\n      <h1>Your Orders</h1>\r\n      {orderedItems.length === 0 && !orderPlaced ? (\r\n        <p>No orders yet. Start shopping!</p>\r\n      ) : (\r\n        <div className=\"ordered-items-list\">\r\n          {orderedItems.map((item, index) => (\r\n            <div key={index} className=\"ordered-item\">\r\n              <h3>{item.name}</h3>\r\n              <p>Price: ₹{item.price.toFixed(2)}</p>\r\n              <div className=\"quantity-controls\">\r\n                <button\r\n                  className=\"small-button\"\r\n                  onClick={() => handleDecreaseQuantity(index)}\r\n                  disabled={item.quantity === 1}\r\n                >\r\n                  -\r\n                </button>\r\n                <span>{item.quantity}</span>\r\n                <button\r\n                  className=\"small-button\"\r\n                  onClick={() => handleIncreaseQuantity(index)}\r\n                >\r\n                  +\r\n                </button>\r\n                <button className=\"delete-button\" onClick={() => handleDeleteItem(index)}>Delete</button>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n      {orderedItems.length > 0 && (\r\n        <div className=\"order-summary\">\r\n          <h3>Total Price: ₹{totalPrice.toFixed(2)}</h3>\r\n          <button className=\"order-now-button\" onClick={handleOrderNow}>Order Now</button>\r\n        </div>\r\n      )}\r\n      {orderPlaced && <div className=\"order-placed-message\">Your Order is Placed!</div>}\r\n      <button className=\"go-back-button\" onClick={() => navigate(-1)}>Go Back</button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserOrders;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}